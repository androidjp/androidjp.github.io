<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-smile.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-smile.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.4.2',
    exturl: false,
    sidebar: {"position":"right","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: true,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="这个问题，平时没想过，谁没事干往一个String头上放几个G的data嘛，但是一旦遇到，就问你怎么解决~！">
<meta name="keywords" content="Java">
<meta property="og:type" content="article">
<meta property="og:title" content="String有最大长度吗？">
<meta property="og:url" content="http:&#x2F;&#x2F;jpuneng.cn&#x2F;String%E6%9C%89%E6%9C%80%E5%A4%A7%E9%95%BF%E5%BA%A6%E5%90%97%EF%BC%9F&#x2F;index.html">
<meta property="og:site_name" content="jpuneng技术栈">
<meta property="og:description" content="这个问题，平时没想过，谁没事干往一个String头上放几个G的data嘛，但是一旦遇到，就问你怎么解决~！">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http:&#x2F;&#x2F;jpuneng.cn&#x2F;images&#x2F;20200301&#x2F;1.png">
<meta property="og:image" content="http:&#x2F;&#x2F;jpuneng.cn&#x2F;images&#x2F;20200301&#x2F;2.png">
<meta property="og:updated_time" content="2020-09-27T07:52:31.705Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http:&#x2F;&#x2F;jpuneng.cn&#x2F;images&#x2F;20200301&#x2F;1.png">

<link rel="canonical" href="http://jpuneng.cn/String%E6%9C%89%E6%9C%80%E5%A4%A7%E9%95%BF%E5%BA%A6%E5%90%97%EF%BC%9F/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>String有最大长度吗？ | jpuneng技术栈</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">jpuneng技术栈</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">技术时代，舍我其谁</p>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="搜索..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://jpuneng.cn/String%E6%9C%89%E6%9C%80%E5%A4%A7%E9%95%BF%E5%BA%A6%E5%90%97%EF%BC%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Jasper Wu">
      <meta itemprop="description" content="醒目点、自觉点、速度点，努力奋斗下去，走好自己的路！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="jpuneng技术栈">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          String有最大长度吗？
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-03-01 17:54:56" itemprop="dateCreated datePublished" datetime="2020-03-01T17:54:56+08:00">2020-03-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-27 15:52:31" itemprop="dateModified" datetime="2020-09-27T15:52:31+08:00">2020-09-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <blockquote>
<p>这个问题，平时没想过，谁没事干往一个String头上放几个G的data嘛，但是一旦遇到，就问你怎么解决~！</p>
</blockquote>
<a id="more"></a>

<h1 id="Java-String有最大长度吗？"><a href="#Java-String有最大长度吗？" class="headerlink" title="Java String有最大长度吗？"></a>Java String有最大长度吗？</h1><h2 id="String内部结构分析"><a href="#String内部结构分析" class="headerlink" title="String内部结构分析"></a>String内部结构分析</h2><p><img src="/images/20200301/1.png" alt=""></p>
<p>看看接口<code>CharSequence</code>:</p>
<p><img src="/images/20200301/2.png" alt=""></p>
<p>打开<code>java.lang.String</code>源码，可以发现：</p>
<ol>
<li>有哪些字段： <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// 存储字符的容器</span><br><span class="line">private final char value[];</span><br><span class="line"></span><br><span class="line">// 缓存字符串的hashCode</span><br><span class="line">private int hash; // Default to 0</span><br><span class="line"></span><br><span class="line">/** use serialVersionUID from JDK 1.0.2 for interoperability */</span><br><span class="line">private static final long serialVersionUID = -6849794470754667710L;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Class String is special cased within the Serialization Stream Protocol.</span><br><span class="line"> *</span><br><span class="line"> * A String instance is written into an ObjectOutputStream according to</span><br><span class="line"> * &lt;a href=&quot;&#123;@docRoot&#125;/../platform/serialization/spec/output.html&quot;&gt;</span><br><span class="line"> * Object Serialization Specification, Section 6.2, &quot;Stream Elements&quot;&lt;/a&gt;</span><br><span class="line"> */</span><br><span class="line">private static final ObjectStreamField[] serialPersistentFields =</span><br><span class="line">    new ObjectStreamField[0];</span><br></pre></td></tr></table></figure></li>
<li>哪些相关构造器： <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">// 将传入的字符数组，从 value[offset]到 value[offset+count] 这一段复制出来构造一个新的字符数组</span><br><span class="line">public String(char value[], int offset, int count) &#123;</span><br><span class="line">    if (offset &lt; 0) &#123;</span><br><span class="line">        throw new StringIndexOutOfBoundsException(offset);</span><br><span class="line">    &#125;</span><br><span class="line">    if (count &lt;= 0) &#123;</span><br><span class="line">        if (count &lt; 0) &#123;</span><br><span class="line">            throw new StringIndexOutOfBoundsException(count);</span><br><span class="line">        &#125;</span><br><span class="line">        if (offset &lt;= value.length) &#123;</span><br><span class="line">            this.value = &quot;&quot;.value;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    // Note: offset or count might be near -1&gt;&gt;&gt;1.</span><br><span class="line">    if (offset &gt; value.length - count) &#123;</span><br><span class="line">        throw new StringIndexOutOfBoundsException(offset + count);</span><br><span class="line">    &#125;</span><br><span class="line">    this.value = Arrays.copyOfRange(value, offset, offset+count);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 从一个Unicode码数组上面copy一部分创建一个新的字符数组</span><br><span class="line"> * @since  1.5</span><br><span class="line"> */</span><br><span class="line">public String(int[] codePoints, int offset, int count) &#123;</span><br><span class="line">    if (offset &lt; 0) &#123;</span><br><span class="line">        throw new StringIndexOutOfBoundsException(offset);</span><br><span class="line">    &#125;</span><br><span class="line">    if (count &lt;= 0) &#123;</span><br><span class="line">        if (count &lt; 0) &#123;</span><br><span class="line">            throw new StringIndexOutOfBoundsException(count);</span><br><span class="line">        &#125;</span><br><span class="line">        if (offset &lt;= codePoints.length) &#123;</span><br><span class="line">            this.value = &quot;&quot;.value;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    // Note: offset or count might be near -1&gt;&gt;&gt;1.</span><br><span class="line">    if (offset &gt; codePoints.length - count) &#123;</span><br><span class="line">        throw new StringIndexOutOfBoundsException(offset + count);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    final int end = offset + count;</span><br><span class="line"></span><br><span class="line">    // Pass 1: Compute precise size of char[]</span><br><span class="line">    int n = count;</span><br><span class="line">    for (int i = offset; i &lt; end; i++) &#123;</span><br><span class="line">        int c = codePoints[i];</span><br><span class="line">        if (Character.isBmpCodePoint(c))</span><br><span class="line">            continue;</span><br><span class="line">        else if (Character.isValidCodePoint(c))</span><br><span class="line">            n++;</span><br><span class="line">        else throw new IllegalArgumentException(Integer.toString(c));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // Pass 2: Allocate and fill in char[]</span><br><span class="line">    final char[] v = new char[n];</span><br><span class="line"></span><br><span class="line">    for (int i = offset, j = 0; i &lt; end; i++, j++) &#123;</span><br><span class="line">        int c = codePoints[i];</span><br><span class="line">        if (Character.isBmpCodePoint(c))</span><br><span class="line">            v[j] = (char)c;</span><br><span class="line">        else</span><br><span class="line">            Character.toSurrogates(c, v, j++);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    this.value = v;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>String.copyValueOf()方法： <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public static String copyValueOf(char data[], int offset, int count) &#123;</span><br><span class="line">    return new String(data, offset, count);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>从以上源码种种迹象</p>
<ul>
<li><code>length()</code>返回的是int类型；</li>
<li>构造器传入的<code>count</code>也是int类型；</li>
</ul>
<p>，都可以断定，String的长度不会超过<code>int</code>的最大值，换言之，<code>char value[]</code> 中最多可以保存<code>Integer.MAX_VALUE</code>个，即2147483647字符。</p>
<p>但事情是不是这样的呢？</p>
<p>我们需要分编译期和运行期来看：</p>
<h2 id="编译期"><a href="#编译期" class="headerlink" title="编译期"></a>编译期</h2><p>编译期，也就是从源码角度表面上看，我取一个<code>Integer.MAX_VALUE</code>长度的字符串，理论上没问题，因为我没有突破你 int 的最大长度。</p>
<p>但是，实验证明，<code>String s = &quot;&quot;;</code>中，最多可以有65534个字符。如果超过这个个数。就会在编译期报错。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">    // 共65534个a，正常编译</span><br><span class="line">    String s = &quot;a...a&quot;;</span><br><span class="line">    System.out.println(s.length());</span><br><span class="line"></span><br><span class="line">    // 共65535个a，编译报错：错误: 常量字符串过长</span><br><span class="line">    String s1 = &quot;a...a&quot;;</span><br><span class="line">    System.out.println(s1.length());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>明明说好的长度限制是2147483647，为什么65535个字符就无法编译了呢？</strong></p>
<p>当我们使用字符串字面量直接定义String的时候，是会把字符串在常量池中存储一份的。那么上面提到的65534其实是常量池的限制。<br>常量池中的每一种数据项也有自己的类型。Java中的UTF-8编码的Unicode字符串在常量池中以CONSTANT_Utf8类型表示。<br>CONSTANTUtf8info是一个CONSTANTUtf8类型的常量池数据项，它存储的是一个常量字符串。常量池中的所有字面量几乎都是通过CONSTANTUtf8info描述的。CONSTANTUtf8_info的定义如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CONSTANT_Utf8_info &#123;</span><br><span class="line">    u1 tag;</span><br><span class="line">    u2 length;</span><br><span class="line">    u1 bytes[length];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>由于本文的重点并不是CONSTANTUtf8info的介绍，这里就不详细展开了，我们只需要我们使用<strong>字面量</strong>定义的字符串在class文件中，是使用CONSTANTUtf8info存储的，而CONSTANTUtf8info中有u2 length;表明了该类型存储数据的长度。<br>u2是无符号的16位整数，因此理论上允许的的最大长度是2^16=65536。而 java class 文件是使用一种变体UTF-8格式来存放字符的，null 值使用两个 字节来表示，因此只剩下 65536－ 2 ＝ 65534个字节。<br>关于这一点，在the class file format spec中也有明确说明：</p>
<blockquote>
<p>The length of field and method names, field and method descriptors, and other constant string values is limited to 65535 characters by the 16-bit unsigned length item of the CONSTANTUtf8info structure (§4.4.7). Note that the limit is on the number of bytes in the encoding and not on the number of encoded characters. UTF-8 encodes some characters using two or three bytes. Thus, strings incorporating multibyte characters are further constrained.</p>
</blockquote>
<p>也就是说，在Java中，所有需要保存在常量池中的数据，长度最大不能超过65535，这当然也包括字符串的定义咯。</p>
<h2 id="运行期"><a href="#运行期" class="headerlink" title="运行期"></a>运行期</h2><p>上面提到的这种String长度的限制是编译期的限制，也就是使用String s= “”;这种字面值方式定义的时候才会有的限制。<br>那么。String在运行期有没有限制呢，答案是有的，就是我们前文提到的那个Integer.MAX_VALUE ，这个值约等于4G，在运行期，如果String的长度超过这个范围，就可能会抛出异常。(在jdk 1.9之前）<br>int 是一个 32 位变量类型，取正数部分来算的话，他们最长可以有</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">2^31-1 =2147483647 个 16-bit Unicodecharacter</span><br><span class="line"></span><br><span class="line">2147483647 * 16 = 34359738352 位</span><br><span class="line">34359738352 / 8 = 4294967294 (Byte)</span><br><span class="line">4294967294 / 1024 = 4194303.998046875 (KB)</span><br><span class="line">4194303.998046875 / 1024 = 4095.9999980926513671875 (MB)</span><br><span class="line">4095.9999980926513671875 / 1024 = 3.99999999813735485076904296875 (GB)</span><br></pre></td></tr></table></figure>
<p>有近 4G 的容量。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul>
<li>当我们在写代码时使用字面量形式去定义String对象，那么，对象最大长度是：65534（因为它需要被编译进常量池的StringTable当中，JVM编译时对在StringTable中生成的String对象会以CONSTANT_Utf8类型表示，而这个类型有个长度属性是无符号16位整数，而由于一些字符已经占用一些，所以最终剩下：65534个字节）；</li>
<li>当我们在运行时接受或动态构造一个String对象，那么，对象最大长度可达：Integer.MAX_VALUE个,即2147483647字符。</li>
</ul>
<h1 id="重温Java基本类型"><a href="#重温Java基本类型" class="headerlink" title="重温Java基本类型"></a>重温Java基本类型</h1><table>
<thead>
<tr>
<th>基本类型–numeric</th>
<th>占用字节数/byte</th>
<th>取值范围</th>
</tr>
</thead>
<tbody><tr>
<td>byte</td>
<td>1</td>
<td><code>[-128, 127]</code></td>
</tr>
<tr>
<td>short</td>
<td>2</td>
<td><code>[-32768,32767]</code> 或 <code>$[-2^{15}, 2^{15}-1]$</code></td>
</tr>
<tr>
<td>int</td>
<td>4</td>
<td><code>[0x80000000, 0x7fffffff]</code> 或 <code>$[-2^{31}, 2^{31}-1]$</code></td>
</tr>
<tr>
<td>long</td>
<td>8</td>
<td><code>[0x8000000000000000L, 0x7fffffffffffffffL]</code> 或 <code>$[-2^{63}, 2^{63}-1]$</code></td>
</tr>
<tr>
<td>char</td>
<td>2</td>
<td><code>[&#39;\u0000&#39;, &#39;\uFFFF&#39;]</code></td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>基本类型–floating-point</th>
<th>占用字节数/byte</th>
<th>取值范围</th>
</tr>
</thead>
<tbody><tr>
<td>float</td>
<td>4</td>
<td><code>[0x0.000002P-126f, 0x1.fffffeP+127f]</code> 或 <code>[1.4e-45f, 3.4028235e+38f]</code></td>
</tr>
<tr>
<td>double</td>
<td>8</td>
<td><code>[0x0.0000000000001P-1022, 0x1.fffffffffffffP+1023]</code> 或 <code>[4.9e-324,1.7976931348623157e+308]</code></td>
</tr>
</tbody></table>
<blockquote>
<p>注意，以上的所有基本类型，都有其对应的封装类型：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Number子类：</span><br><span class="line">    Integer</span><br><span class="line">    Short</span><br><span class="line">    Integer</span><br><span class="line">    Long</span><br><span class="line">    Float</span><br><span class="line">    Double</span><br><span class="line"></span><br><span class="line">Character</span><br></pre></td></tr></table></figure>
<p>发现，除了<code>Character</code>，其他都是继承<code>Number</code>。</p>
</blockquote>
<h1 id="扩展：Java数组也有最大长度吗？"><a href="#扩展：Java数组也有最大长度吗？" class="headerlink" title="扩展：Java数组也有最大长度吗？"></a>扩展：Java数组也有最大长度吗？</h1><p>看了String的源码也知道，其内部是一个<code>char[]</code>类型的字符数组，我们调用String的length()函数时，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String s = &quot;hhh&quot;;</span><br><span class="line">s.length();</span><br></pre></td></tr></table></figure>
<p>发现实际其内部是调用了<code>char[].length</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public final class String</span><br><span class="line">    implements java.io.Serializable, Comparable&lt;String&gt;, CharSequence &#123;</span><br><span class="line">    /** The value is used for character storage. */</span><br><span class="line">    private final char value[];</span><br><span class="line">    .......</span><br><span class="line">    public int length() &#123;</span><br><span class="line">        return value.length;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>而我们又知道字符串在编译期和运行期的不同，那么，可以得知，对于Java数组：</p>
<ol>
<li>一是规范隐含的限制。Java数组的length必须是非负的int，所以它的理论最大值就是java.lang.Integer.MAX_VALUE = 2^31-1 = 2147483647。</li>
<li>二是具体的实现带来的限制。这会使得实际的JVM不一定能支持上面说的理论上的最大length。<br>例如说如果有JVM使用uint32_t来记录对象大小的话，那可以允许的最大的数组长度（按元素的个数计算）就会是：<br>(uint32_t的最大值 - 数组对象的对象头大小) / 数组元素大小<br>于是对于元素类型不同的数组，实际能创建的数组的最大length也会不同。<br>JVM实现里可以有许多类似的例子会影响实际能创建的数组大小。</li>
</ol>

    </div>

    
    
    
        <div id="wechat_subscriber" style="display: block; padding: 10px 0; margin: 20px auto; width: 100%; text-align: center;">
  <img id="wechat_subscriber_qcode" src="/uploads/wechat-qcode.png" alt="Jasper Wu wechat" style="width: 200px; max-width: 100%;">
  <div>喜欢的朋友可以关注 "JP技术栈" 微信公众号，每周更新笔者最新分享技术文章~</div>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Java/" rel="tag"># Java</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
                <a href="/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%B8%A6Go%E5%B0%8F%E7%99%BD%E5%85%A5%E9%97%A8/" rel="next" title="一篇文章带Go小白入门">
                  <i class="fa fa-chevron-left"></i> 一篇文章带Go小白入门
                </a>
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
                <a href="/Spring%20Boot%20%E9%80%9A%E8%BF%87%E7%B1%BB%E5%90%8D%E6%89%BE%E5%88%B0%E7%B1%BB%E7%9A%84%E8%B8%A9%E5%9D%91%E4%B9%8B%E8%B7%AF/" rel="prev" title="Spring Boot 通过类名找到类的踩坑之路">
                  Spring Boot 通过类名找到类的踩坑之路 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Java-String有最大长度吗？"><span class="nav-number">1.</span> <span class="nav-text">Java String有最大长度吗？</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#String内部结构分析"><span class="nav-number">1.1.</span> <span class="nav-text">String内部结构分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#编译期"><span class="nav-number">1.2.</span> <span class="nav-text">编译期</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#运行期"><span class="nav-number">1.3.</span> <span class="nav-text">运行期</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#总结"><span class="nav-number">1.4.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#重温Java基本类型"><span class="nav-number">2.</span> <span class="nav-text">重温Java基本类型</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#扩展：Java数组也有最大长度吗？"><span class="nav-number">3.</span> <span class="nav-text">扩展：Java数组也有最大长度吗？</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="site-author-image" itemprop="image" alt="Jasper Wu"
    src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Jasper Wu</p>
  <div class="site-description" itemprop="description">醒目点、自觉点、速度点，努力奋斗下去，走好自己的路！</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">39</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">23</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">34</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/androidjp" title="GitHub &amp;rarr; https:&#x2F;&#x2F;github.com&#x2F;androidjp" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:1049578026@qq.com" title="E-Mail &amp;rarr; mailto:1049578026@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 2016 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jasper Wu</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>












        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  






  <script src="/js/local-search.js"></script>










<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme: 'default',
      logLevel: 3,
      flowchart: { curve: 'linear' },
      gantt: { axisFormat: '%m/%d/%Y' },
      sequence: { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>



  

  

  

  

</body>
</html>
